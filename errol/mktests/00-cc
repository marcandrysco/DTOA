#!/bin/sh
# Generated by BetterMake
# md5sum: a9d6525cd72792b8cbbab509064e449b

##
# C Compiler Test
#   Verifies that the current machine and toolchain have a C Compiler
#   installed and checks for dependency tracking.
# Variables
#   cc
#     Set to the available C Compiler.
#   precc
#     Adds dependency tracking to pre compilation.
#   CFLAGS
#     Adds flags for dependency tracking.
#.

test "$cc" && echo "compiler specified ($cc)"

if [ -z "$cc" ] && [ "$CC" ] ; then
	echo -n "checking for compiler (${toolchain}$CC)... "
	which "${toolchain}$CC" > /dev/null && { echo yes ; cc="${toolchain}$CC" ; } || echo no
fi

if [ -z "$cc" ] ; then
	echo -n "checking for compiler (${toolchain}gcc)... "
	which "${toolchain}gcc" > /dev/null && { echo yes ; cc="${toolchain}gcc" ; } || echo no
fi

if [ -z "$cc" ] ; then
	echo -n "checking for compiler (${toolchain}cc)... "
	which "${toolchain}cc" > /dev/null && { echo yes ; cc="${toolchain}cc" ; } || echo no
fi

test -z "$cc" && { echo "error: no compiler found" ; exit 1 ; }

precc="$precc if [ ! -d \"\$(@D)/$depdir\" ] ; then mkdir \"\$(@D)/$depdir\" ; fi ; "
CFLAGS="$CFLAGS -MD -MP -MF \$(@D)/$depdir/\$(@F).dep"
