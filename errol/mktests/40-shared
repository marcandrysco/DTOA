#!/bin/sh
# Generated by BetterMake
# md5sum: d8796baf6382a9790faeeb37efb25373

##
# Linker Test
#   Tests to determine if shared libraries are supported, and determines if
#   additional parameters are necessary to build libraries.
# Variables
#   dynlib
#     Set to the default extension for the shared library type. Typicall is
#     either 'so' or 'dll'. This will be unset if shared libraries are not
#     supported.
#   fpic
#     Set to '-fPIC' or '-fpic' if position independent code is necessary for
#     building shared libraries.
#.

echo -n "dynamic library support... "

if [ "$toolchain" ] && [ -z "${toolchain%%*mingw*}" ] ; then
	echo dll ; dynlib=dll
else
	echo so ; dynlib=so

	echo -n "checking if -fpic is supported... "
	echo "int testfunc() { return 0; }" > mktests/tmp.c
	if [ ! -f mktests/tmp.c ] ; then echo error ; return 1 ; fi

	$cc mktests/tmp.c -Wall -Werror -shared -fpic -o mktests/tmp.out >> config.log 2>&1
	if [ $? -eq 0 ] && [ -f mktests/tmp.out ] ; then
		echo yes ; pic=yes
	else
		echo no ; pic=no
	fi
fi
